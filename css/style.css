/* Base palette & tokens */
:root {
    --bg: #12111b;
    --bg-alt: #181728;
    --text: #d9d9e6;
    --text-dim: #8891a8;
    --link: #68a9ff;
    --link-hover: #8cc4ff;
    --accent-grad: linear-gradient(90deg,#d665ff,#7d2bff);
    --accent1: #d665ff;
    --accent2: #7d2bff;
    --border: #27263a;
    --radius: 6px;
    --mono: "IBM Plex Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
    --sans: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
    --max-width: 880px;
    --transition: 180ms cubic-bezier(.4,.2,.2,1);
}
* { box-sizing: border-box; }
html, body { height:100%; }
body {
    margin:0;
    font-family: var(--sans);
    background: var(--bg);
    color: var(--text);
    -webkit-font-smoothing: antialiased;
    overflow-x:hidden;
}

a { color: var(--link); text-decoration:none; }
a:hover, a:focus-visible { color: var(--link-hover); text-decoration:underline; }

.site-header {
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    padding: clamp(.75rem,1.4vw,1.2rem) clamp(1rem,2vw,2rem);
    max-width: var(--max-width);
    margin:0 auto;
}
.brand { display:flex; align-items:center; gap: .95rem; max-width: 65%; }
.logo { display:block; filter: drop-shadow(0 2px 4px rgba(0,0,0,.35)); flex-shrink: 0; }
.site-title {
    font-family: var(--mono);
    font-size: clamp(1.6rem, 2.1vw, 2.2rem);
    margin:0;
    font-weight:500;
    letter-spacing:.5px;
    display:flex;
    align-items:center;
    gap:.4rem;
    min-width: 0; /* Allow flex shrinking */
}
.site-title .hash {
    /* Gradient (no glow) for the leading hash */
    background: var(--accent-grad);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    -webkit-text-fill-color: transparent; /* Safari */
    font-weight:600;
    /* removed glow */
    text-shadow:none;
}
.site-title .domain {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    min-width: 0;
    color: #ffffff; /* Keep title white */
}

.main-nav {
    flex-shrink: 0; /* Prevent nav from shrinking */
}

.main-nav ul {
    list-style:none;
    display:flex;
    gap:.6rem;
    margin: .35rem 0 0;
    padding:0;
    font-family: var(--mono);
    font-size:.9rem;
}
.main-nav a {
    padding:.25rem .55rem;
    border-radius:4px;
    position:relative;
    color: var(--link);
    display:inline-block;
    line-height:1.2;
    transition: background var(--transition), color var(--transition);
}
.main-nav a.active {
    background:#2c3652;
    color: var(--link-hover);
}
.main-nav a:hover:not(.active) {
    background:#1d2333;
    text-decoration:none;
}

.content {
    max-width: var(--max-width);
    margin: 0 auto;
    padding: 0 clamp(1rem,2vw,2rem) 4rem;
    min-height:calc(100dvh - 100px);
    font-family: var(--mono);
    line-height:1.52;
    font-size: 15px;
}

.narrow { max-width: 640px; }

.home-links, .post-list {
    list-style:none;
    margin:2.5rem 0;
    padding:0;
    font-size:.92rem;
    letter-spacing:.5px;
}
.home-links li,
.post-list li {
    margin:.55rem 0;
}
.arrow { color: var(--accent1); margin-right:.55rem; }

.post-list a { text-decoration:none; }
.post-list a:hover { text-decoration:underline; }

.markdown h2, .markdown h1, .markdown h3, .markdown h4 {
    font-weight:600;
    letter-spacing:.5px;
    margin:2.4rem 0 1rem;
    position:relative;
}
.markdown h1:first-child,
.markdown h2:first-child { margin-top:0; }

.markdown h1 .hash, .markdown h2 .hash {
    color: var(--accent1);
}

/* Anchor link */
.markdown a.anchor {
    opacity:0;
    position:absolute;
    left:-1.4rem;
    top:50%;
    transform:translateY(-50%);
    text-decoration:none;
    font-size:.9rem;
    color:var(--accent1);
    transition:opacity var(--transition);
}
.markdown h1:hover .anchor, .markdown h2:hover .anchor, .markdown h3:hover .anchor, .markdown h4:hover .anchor { opacity:.9; }

/* Copy code button */
pre.has-copy { position:relative; }
.copy-code {
    position:absolute;
    top:.55rem; right:.6rem;
    background:#231f33;
    color:var(--text-dim);
    border:1px solid #36334a;
    font-family:var(--mono);
    font-size:.65rem;
    padding:.3rem .55rem;
    border-radius:4px;
    cursor:pointer;
    transition:background var(--transition), color var(--transition), border-color var(--transition);
}
.copy-code:hover { background:#2d2842; color:#fff; }
.copy-code:active { transform:translateY(1px); }

/* Footnote popover */
.fn-ref { background:#1d1a2a; color:var(--link); border:1px solid #2d2940; border-radius:4px; cursor:pointer; font-family:var(--mono); font-size:.72rem; padding:.05rem .35rem; }
.fn-ref:hover { background:#252137; }
.fn-popover { display:inline-block; margin-left:.4rem; position:relative; }
.fn-popover .fn-box { background:#1a1628; border:1px solid #3c2c55; padding:.55rem .7rem; font-size:.72rem; max-width:300px; line-height:1.35; border-radius:6px; box-shadow:0 6px 16px -4px rgba(0,0,0,.55),0 0 0 1px #2d2440 inset; }

.markdown p, .markdown ul, .markdown ol {
    margin: 1rem 0;
    max-width: 70ch;
}
/* Reduced paragraph spacing */
.markdown p { margin: .5rem 0; }

.markdown code {
    background:#1c1b2a;
    padding:.15rem .4rem;
    border-radius:4px;
    font-size:.85em;
    border:1px solid #2a2940;
}

.markdown pre {
    background:#1c1b2b;
    padding:1rem 1.2rem;
    border-radius:8px;
    overflow:auto;
    border:1px solid #2b2a42;
    font-size:.85rem;
    line-height:1.4;
}

.markdown blockquote {
    border-left:3px solid var(--accent1);
    margin:1.2rem 0;
    padding:.3rem .9rem;
    color: var(--text-dim);
    background:#1a1926;
    border-radius:4px;
}

.angled {
    list-style:none;
    padding:0;
    margin:1rem 0 1.5rem;
}
.angled li {
    margin:.45rem 0;
    max-width:70ch;
}
.angled .arrow { margin-right:.6rem; }

hr {
    border:none;
    border-top:1px solid #3e3a58; /* lighter for better contrast */
    margin:2.5rem 0;
    opacity:0.85;
}

.tag-groups { margin:2rem 0 3rem; }
.tag-cloud {
    display:flex;
    flex-wrap:wrap;
    gap:.7rem .9rem;
    margin:1.2rem 0;
    max-width: 750px;
}
.tag {
    padding:.45rem .9rem;
    border:1px solid var(--accent1);
    border-radius:14px;
    font-size:.72rem;
    letter-spacing:.06em;
    background:rgba(214,101,255,0.06);
    white-space:nowrap;
    transition:background var(--transition), color var(--transition), border-color var(--transition);
}
.tag:hover {
    background:rgba(214,101,255,0.16);
    color:#fff;
}

.loading { color: var(--text-dim); margin-top:3rem; }

.post-nav {
    margin:3rem 0 4rem;
    font-size:.85rem;
}

.readable { max-width: 900px; }

@media (max-width: 720px) {
    .site-header {
        flex-direction:column;
        align-items:flex-start;
        gap:.6rem;
    }
    .main-nav ul { flex-wrap:wrap; }
    .content { padding: 0 1rem 3rem; }
}

/* Focus outlines */
a:focus-visible, button:focus-visible {
    outline:2px solid var(--accent1);
    outline-offset:2px;
}

/* Starfield canvases */
#starfield, #shooting, #glstars {
    position:fixed;
    inset:0;
    width:100%;height:100%;
    z-index:-1;
    pointer-events:none;
    background: radial-gradient(circle at 40% 60%, #18162b 0%, transparent 60%);
}

/* Scrollbar (webkit) */
::-webkit-scrollbar { width:11px; }
::-webkit-scrollbar-track { background:#141320; }
::-webkit-scrollbar-thumb {
    background:#27263a;
    border-radius:20px;
    border:2px solid #141320;
}
::-webkit-scrollbar-thumb:hover { background:#34324b; }

/* Utility */
.hidden { display:none !important; }

.site-footer { margin-top:4rem; border-top:1px solid #221f32; padding:2.2rem 0 3.5rem; font-family:var(--mono); font-size:.65rem; letter-spacing:.12em; text-transform:uppercase; color:var(--text-dim); }
.site-footer .inner { max-width:var(--max-width); margin:0 auto; padding:0 clamp(1rem,2vw,2rem); display:flex; flex-wrap:wrap; gap:1rem; align-items:center; }
.site-footer a { color:var(--link); text-decoration:none; }
.site-footer a:hover { text-decoration:underline; }
.heart { color:#ff5fa7; }

.rss-badge { background:#2b2240; border:1px solid #3a3054; border-radius:999px; padding:.28rem .75rem !important; font-size:.7rem; text-transform:uppercase; letter-spacing:.15em; color:#d9d9e6 !important; display:inline-flex; align-items:center; gap:.3rem; }
.rss-badge:hover { background:#342a52; text-decoration:none !important; }
.rss-badge:before { content:'⟲'; font-size:.8rem; opacity:.8; }

.rss-inline { background:#241d39; padding:.25rem .6rem; border-radius:999px; border:1px solid #3a3054; font-size:.6rem; letter-spacing:.15em; text-transform:uppercase; }
.rss-inline:hover { background:#31264d; text-decoration:none; }

.rss-mini { font-size:.6rem; letter-spacing:.15em; text-transform:uppercase; background:#241d39; padding:.25rem .55rem; border-radius:8px; border:1px solid #352d4a; }
.rss-mini:hover { background:#302446; }

.draft-watermark { position:relative; margin:-1rem 0 1rem; font-family:var(--mono); font-size:4rem; font-weight:700; line-height:1; letter-spacing:.08em; background:linear-gradient(90deg,#552266,#221033); -webkit-background-clip:text; color:transparent; opacity:.08; user-select:none; pointer-events:none; text-align:right; }
@media (max-width:720px){ .draft-watermark{ font-size:2.8rem; text-align:left; } }

/* Bubble list (About page) */
.bubbles { display:flex; flex-wrap:wrap; gap:.55rem .7rem; margin:1.2rem 0 2rem; }
.bubble { display:inline-block; font-size:.62rem; letter-spacing:.12em; text-transform:uppercase; padding:.4rem .7rem .38rem; border:1px solid var(--accent1); border-radius:10px; background:transparent; color:var(--text-dim); font-family:var(--mono); white-space:nowrap; }
.bubble:hover { background:rgba(214,101,255,0.08); color:#fff; }

/* Post page header spacing */
body.is-post .site-header { padding-top: 2rem; }
@media (max-width:720px){ body.is-post .site-header { padding-top: 1.4rem; } }

/* Glowing # prefix for markdown headings */
/* Replace glow with flat gradient for all markdown heading hash prefixes */
.markdown h1::before,
.markdown h2::before,
.markdown h3::before,
.markdown h4::before {
  content:'#';
  margin-right:.55rem;
  font-weight:600;
  display:inline-block;
  background: var(--accent-grad);
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent; /* gradient text */
  text-shadow:none; /* ensure no glow */
  -webkit-text-fill-color: transparent; /* Safari */
}
/* Anchor permalink hash (#) inside headings: match gradient, no glow */
.markdown a.anchor {
  background: var(--accent-grad);
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
  -webkit-text-fill-color: transparent; /* Safari */
}

.toc { border:none; background:transparent !important; padding:0; margin:1.2rem 0 1.2rem; color: var(--link); }
.toc-title { display:none; }
.toc-list { list-style:none; margin:0; padding:0; }
.toc-item { position:relative; padding-left:18px; margin:.25rem 0; color: var(--link); }
.toc-item::before { content:'›'; position:absolute; left:0; color: var(--link); }
.toc-sub { margin-left:16px; list-style:none; padding:0; }
.toc-item > a { color: var(--link); text-decoration:none; display:inline-block; padding:.1rem .25rem; border-radius:6px; transition: color var(--transition); background:transparent !important; }
.toc-item > a:hover { background:transparent !important; color: var(--link-hover); text-decoration:underline; }

/* Footnotes list */
.footnotes { margin:2.4rem 0 1rem; padding-top:1rem; border-top:1px solid #2a273b; font-size:.68rem; line-height:1.4; }
.footnotes ol { margin:0 0 0 1.1rem; padding:0; }
.footnotes li { margin:.45rem 0; }
.fn-back { margin-left:.35rem; text-decoration:none; font-size:.7em; color: var(--accent1); }
.fn-back:hover { text-decoration:underline; }

/* TOC force override to ensure blue takes effect */
.toc, .toc-item, .toc-item > a { color: var(--link) !important; }
.toc-item::before { color: var(--link) !important; }
.toc-item > a:hover { color: var(--link-hover) !important; }
.toc-item > a:link,
.toc-item > a:visited,
.toc-item > a:active,
.toc-item > a:focus { color: var(--link) !important; }
